import{_ as w,I as p,cE as R,s as r,o as m,c as u,e as t,g,w as L,t as i,aW as d,bb as v,aX as f,F as B,m as I,n as $}from"./index-8f557042.js";import{U as _,_ as T}from"./index-e5c76592.js";/* empty css               */import{_ as b}from"./index-ea640345.js";import{b as U}from"./browser-97ced81c.js";import{A as c}from"./recharge-05b01178.js";import"./index-1b600eb6.js";import"./index-cae364d9.js";import"./index-3e1fbb16.js";const M={name:"rechargePage",components:{[_.name]:_,[p.name]:p,assetsHead:b},data(){return{BASE_URL:R,tip:"",fileList:[],address:"",nowUrl:"",session_token:"",amount:"",from:"",coin:"",blockchainIndex:0,blockchain_name:"",chainList:[],QRCodeMsg:"",imgshow:!1,img:"",enterAddress:""}},mounted(){this.nowUrl="https://"+window.location.hostname,this.coin=this.$route.query.symbol,this.getData(),this.getToken(),c.getRechargeTips({language:this.$i18n.locale,token:this.$store.state.user.userInfo.token,content_code:"002"}).then(e=>{console.log("\u5145\u503C\u63D0\u793A",e),this.tip=(e==null?void 0:e.content)||""})},methods:{openRecord(){this.$router.push({path:"/cryptos/assetsCenter/rechargeWithdrawRecord",query:{back:"1"}})},getData(){c.getBlock({coin:this.coin}).then(e=>{this.chainList=e,this.address=e[0].address,this.blockchain_name=e[0].blockchain_name,this.getQRCode()})},changeBlockchain(e){this.blockchainIndex=e,this.address=this.chainList[this.blockchainIndex].address,this.blockchain_name=this.chainList[this.blockchainIndex].blockchain_name,this.getQRCode()},getToken(){c.getRechargeToken().then(e=>{this.session_token=e.session_token})},onClickLeft(){this.$router.go(-1)},copy(e){!e||navigator.clipboard.writeText(e).then(()=>{r(this.$t("\u590D\u5236\u6210\u529F"))})},beforeRead(e){return["image/jpeg","image/jpg","image/gif","image/bmp","image/png"].includes(e.type)?!0:(r(this.$t("\u4E0A\u4F20\u56FE\u7247\u53EA\u80FD\u662FJPG\u3001JPEG\u3001gif\u3001bmp\u3001PNG\u683C\u5F0F!")),!1)},async afterRead(e){e.status="uploading",e.message=this.$t("uploading"),T(e).then(s=>{e.status="success",e.message=this.$t("uploadSuccess"),r(this.$t("uploadSuccess")),e.resURL=s}).catch(s=>{e.status="failed",e.message=this.$t("uploadFailed")})},getQRCode(){let e={errorCorrectionLevel:"H",type:"image/png",quality:.3,margin:4,width:200,height:200,text:"http://www.xxx.com",color:{dark:"#333333",light:"#fff"}};this.QRCodeMsg=this.address;let s=document.getElementById("QRcodeCanvas");U.toCanvas(s,this.QRCodeMsg,e,function(l){console.log(l)}),this.img=s.toDataURL("image/png"),this.imgshow=!0},download(e){const s=document.querySelector(e),l=document.createElement("a");l.href=s.toDataURL(),l.download="123";const x=new MouseEvent("click");l.dispatchEvent(x)},nextBtn(){if(!this.amount){r(this.$t("\u8BF7\u8F93\u5165\u6570\u91CF"));return}if(!/^[0-9]+([.]{1}[0-9]+){0,1}$/.test(this.amount)){r(this.$t("\u8BF7\u8F93\u5165\u6570\u5B57"));return}this.amount?c.rechargeApply({session_token:this.session_token,amount:this.amount,from:this.enterAddress,blockchain_name:this.blockchain_name,img:this.fileList.length>0?this.fileList[0].resURL:"",coin:this.coin,channel_address:this.address,tx:""}).then(s=>{this.$router.push({path:"/cryptos/recharge/rechargeSubmit",query:{orderTime:s.orderTime}})}).catch(s=>{s.code==="ECONNABORTED"?r(this.$t("\u7F51\u7EDC\u8D85\u65F6\uFF01")):s.msg!==void 0&&r(this.$t(s.msg)),this.getToken()}):r(this.$t("\u8BF7\u8F93\u5165\u5145\u5E01\u6570\u91CF"))}}},A={id:"cryptos"},E={class:"rechargePage box-border px-8 text-28"},Q={class:"mt-8 w-full text-center text-36 textColor"},D={class:"pl-8 pt-8 pr-8 text-center flex flex-col items-center justify-center mt40"},P={id:"QRcodeCanvas"},S=["src"],V={class:"pl-2 pr-2 text-28"},q={class:"flex flex-col items-center justify-center text-28"},N={class:"textColor text-28"},j={style:{position:"relative"},class:"mt-6 mb-5 text-28"},F=["placeholder"],H={class:"mb-5"},G={class:"text-28 textColor"},J=["placeholder"],O={class:"text-28 textColor"},W={class:"flex"},z=["onClick"],X={class:"text-28 textColor"},Y={class:"img-box"},K={class:"hint-box"},Z={class:"pl-8 pr-8"},ee={class:"text-30 mb-7 textColor"},te=["innerHTML"];function se(e,s,l,x,o,a){const k=p,C=b,y=_;return m(),u("div",A,[t("div",E,[g(C,{title:e.$t("\u5FEB\u901F\u5145\u5E01")},{default:L(()=>[g(k,{name:"orders-o",onClick:a.openRecord,class:"list-icon"},null,8,["onClick"])]),_:1},8,["title"]),t("div",Q,i(o.coin.toUpperCase()+" "+e.$t("\u5145\u503C")),1),t("div",D,[t("div",null,[d(t("canvas",P,null,512),[[v,!o.imgshow]]),d(t("img",{src:o.img,alt:"",class:"QRcodeImg"},null,8,S),[[v,o.imgshow]])]),t("div",{class:"code-btn btnMain text-center text-26 text-white",onClick:s[0]||(s[0]=n=>a.download("#QRcodeCanvas"))},i(e.$t("\u4FDD\u5B58\u4E8C\u7EF4\u7801")),1)]),s[7]||(s[7]=t("div",{class:"border-light-grey"},null,-1)),t("div",V,[t("div",q,[t("div",{class:"textColor text-30 mt50",ref:"address"},i(o.address),513),t("div",{onClick:s[1]||(s[1]=n=>a.copy(o.address)),class:"text-26 border-solid-grey text-center code-btn rounded-6 textColor"},i(e.$t("\u590D\u5236\u5730\u5740")),1)]),t("div",null,[t("div",N,i(e.$t("\u8F6C\u51FA\u5730\u5740(\u9009\u586B)")),1),t("div",j,[d(t("input",{style:{"padding-right":"80px"},"onUpdate:modelValue":s[2]||(s[2]=n=>o.enterAddress=n),class:"input-view text-26 textColor inputBackground",placeholder:e.$t("\u8BF7\u8F93\u5165\u8F6C\u51FA\u5730\u5740")},null,8,F),[[f,o.enterAddress]]),t("div",{style:{position:"absolute",right:"10px",top:"50%",color:"#1194F7",transform:"translateY(-50%)"},onClick:s[3]||(s[3]=n=>o.enterAddress=o.address)},i(e.$t("\u7C98\u8D34")),1)])]),t("div",H,[t("div",G,i(e.$t("\u5145\u5E01\u6570\u91CF")),1),t("div",null,[d(t("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>o.amount=n),class:"input-view w-full text-28 textColor inputBackground",placeholder:e.$t("\u8BF7\u8F93\u5165\u5145\u5E01\u6570\u91CF")},null,8,J),[[f,o.amount]])])]),t("div",null,[t("div",O,i(e.$t("\u94FE\u540D\u79F0")),1),t("div",W,[(m(!0),u(B,null,I(o.chainList,(n,h)=>(m(),u("div",{class:$([o.blockchainIndex==h?"borderMain colorMain":"border-solid-dark-grey border-r-grey","mr-5 flex-wrap text-32 text-center name-btn rounded textColor"]),key:h,onClick:oe=>a.changeBlockchain(h)},i(n.blockchain_name),11,z))),128))])]),t("div",null,[t("div",X,i(e.$t("\u4ED8\u6B3E\u51ED\u8BC1\uFF08\u4E0A\u4F20\u652F\u4ED8\u8BE6\u60C5\u622A\u56FE\uFF09")),1),t("div",Y,[g(y,{accept:"image/*",modelValue:o.fileList,"onUpdate:modelValue":s[5]||(s[5]=n=>o.fileList=n),"max-count":1,"before-read":a.beforeRead,"after-read":a.afterRead},null,8,["modelValue","before-read","after-read"])])])]),t("div",K,[t("div",Z,[t("div",ee,i(e.$t("\u91CD\u8981\u63D0\u793A")),1),t("div",{class:"text-28 text-grey",innerHTML:o.tip},null,8,te),t("button",{class:"btnMain text-white next-btn text-30 rounded-lg",onClick:s[6]||(s[6]=(...n)=>a.nextBtn&&a.nextBtn(...n))},i(e.$t("\u4E0B\u4E00\u6B65")),1)])])])])}const ue=w(M,[["render",se],["__scopeId","data-v-09add318"]]);export{ue as default};
