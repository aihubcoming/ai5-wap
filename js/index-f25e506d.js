import{p as D,J as G,z as H,bN as Q,B as V,r as b,aI as tt,b2 as et,ah as ot,a4 as R,aa as st,a9 as z,l as nt,a8 as M,K,g as x,b9 as ct,U as it,b5 as at,b8 as w,aK as O,V as S,W as N,E as rt,a1 as lt,a2 as dt,q as ht,b4 as ft,cM as ut,H as X}from"./index-a1ce0b9b.js";function gt(){const e="A".charCodeAt(0);return Array(26).fill("").map((s,f)=>String.fromCharCode(e+f))}const[Y,C]=D("index-bar"),vt={sticky:G,zIndex:H,teleport:[String,Object],highlightColor:String,stickyOffsetTop:Q(0),indexList:{type:Array,default:gt}},j=Symbol(Y);var pt=V({name:Y,props:vt,emits:["select","change"],setup(e,{emit:g,slots:s}){const f=b(),v=b(),p=b(""),y=tt(),u=et(f),{children:c,linkChildren:T}=ot(j);let r;T({props:e});const q=R(()=>{if(st(e.zIndex))return{zIndex:+e.zIndex+1}}),F=R(()=>{if(e.highlightColor)return{color:e.highlightColor}}),I=(t,o)=>{for(let i=c.length-1;i>=0;i--){const a=i>0?o[i-1].height:0,n=e.sticky?a+e.stickyOffsetTop:0;if(t+n>=o[i].top)return i}return-1},P=t=>c.find(o=>String(o.index)===t),A=()=>{if(at(f))return;const{sticky:t,indexList:o}=e,i=w(u.value),a=O(u),n=c.map(m=>m.getRect(u.value,a));let l=-1;if(r){const m=P(r);if(m){const d=m.getRect(u.value,a);e.sticky&&e.stickyOffsetTop?l=I(d.top-e.stickyOffsetTop,n):l=I(d.top,n)}}else l=I(i,n);p.value=o[l],t&&c.forEach((m,d)=>{const{state:h,$el:Z}=m;if(d===l||d===l-1){const k=Z.getBoundingClientRect();h.left=k.left,h.width=k.width}else h.left=null,h.width=null;if(d===l)h.active=!0,h.top=Math.max(e.stickyOffsetTop,n[d].top-i)+a.top;else if(d===l-1&&r===""){const k=n[l].top-i;h.active=k>0,h.top=k+a.top-n[d].height}else h.active=!1}),r=""},$=()=>{it(A)};z("scroll",A,{target:u,passive:!0}),nt($),M(()=>e.indexList,$),M(p,t=>{t&&g("change",t)});const J=()=>e.indexList.map(t=>{const o=t===p.value;return x("span",{class:C("index",{active:o}),style:o?F.value:void 0,"data-index":t},[t])}),E=t=>{r=String(t);const o=P(r);if(o){const i=w(u.value),a=O(u),{offsetHeight:n}=document.documentElement;if(o.$el.scrollIntoView(),i===n-a.height){A();return}e.sticky&&e.stickyOffsetTop&&(S()===n-a.height?N(S()):N(S()-e.stickyOffsetTop)),g("select",o.index)}},B=t=>{const{index:o}=t.dataset;o&&E(o)},U=t=>{B(t.target)};let L;const W=t=>{if(y.move(t),y.isVertical()){rt(t);const{clientX:o,clientY:i}=t.touches[0],a=document.elementFromPoint(o,i);if(a){const{index:n}=a.dataset;n&&L!==n&&(L=n,B(a))}}},_=()=>x("div",{ref:v,class:C("sidebar"),style:q.value,onClick:U,onTouchstartPassive:y.start},[J()]);return K({scrollTo:E}),z("touchmove",W,{target:v}),()=>{var t;return x("div",{ref:f,class:C()},[e.teleport?x(ct,{to:e.teleport},{default:()=>[_()]}):_(),(t=s.default)==null?void 0:t.call(s)])}}});const[mt,xt]=D("index-anchor"),yt={index:H};var Tt=V({name:mt,props:yt,setup(e,{slots:g}){const s=lt({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),f=b(),{parent:v}=dt(j);if(!v)return;const p=()=>s.active&&v.props.sticky,y=R(()=>{const{zIndex:c,highlightColor:T}=v.props;if(p())return ht(ft(c),{left:s.left?`${s.left}px`:void 0,width:s.width?`${s.width}px`:void 0,transform:s.top?`translate3d(0, ${s.top}px, 0)`:void 0,color:T})});return K({state:s,getRect:(c,T)=>{const r=O(f);return s.rect.height=r.height,c===window||c===document.body?s.rect.top=r.top+S():s.rect.top=r.top+w(c)-T.top,s.rect}}),()=>{const c=p();return x("div",{ref:f,style:{height:c?`${s.rect.height}px`:void 0}},[x("div",{style:y.value,class:[xt({sticky:c}),{[ut]:c}]},[g.default?g.default():e.index])])}}});const bt=X(Tt),St=X(pt);export{St as I,bt as a};
