import{_ as D,v as I,al as A,r as n,l as M,U as u,au as O,o as c,c as g,b as P,d as v,aY as J,F as z,m as E,n as K,t as W,aZ as $,a_ as F,L as U}from"./index-14d2cc83.js";import{k as T}from"./index-55975b32.js";import{a as y}from"./trade.api-43084cdd.js";/* empty css                                                              */const C={grid:{show:!0,horizontal:{show:!0,size:1,color:"rgba(68,75,88,0.04)",style:"solid",dashValue:[2,2]},vertical:{show:!0,size:1,color:"rgba(68,75,88,0.04)",style:"solid",dashValue:[2,2]}},candle:{margin:{top:.5,bottom:.1},type:"candle_solid",bar:{upColor:"#2dbd83",downColor:"#f24760",noChangeColor:"#888888"},area:{lineSize:2,lineColor:"#e7bb41",value:"close",backgroundColor:[{offset:0,color:"rgba(230, 186, 65, 0.01)"},{offset:1,color:"rgba(230, 186, 65, 0.2)"}]},priceMark:{show:!0,high:{show:!0,textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,line:{show:!0,style:"dash",dashValue:[4,4],size:1},text:{show:!0,size:12,paddingLeft:2,paddingTop:2,paddingRight:2,paddingBottom:2,family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:"none",showType:"standard",values:null,defaultValue:"n/a",rect:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:6,offsetLeft:8,offsetTop:8,offsetRight:8,borderRadius:4,borderSize:1},text:{size:12,family:"Helvetica Neue",weight:"normal",marginLeft:8,marginTop:6,marginRight:8,marginBottom:0}}},technicalIndicator:{margin:{top:100,bottom:.1},bar:{},line:{size:1},circle:{},lastValueMark:{show:!1,text:{show:!1,size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:3,paddingTop:2,paddingRight:3,paddingBottom:2,borderRadius:2}},tooltip:{showRule:"always",showType:"standard",showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",marginTop:6,marginRight:8,marginBottom:0,marginLeft:8}}},xAxis:{show:!0,height:null,axisLine:{show:!0,color:"rgba(68,75,88,0.2)",size:1},tickText:{show:!0,family:"Helvetica Neue",weight:"normal",size:12,paddingTop:3,paddingBottom:6},tickLine:{show:!0,size:1,length:3}},yAxis:{show:!0,width:null,position:"right",type:"normal",inside:!1,reverse:!1,axisLine:{show:!1,color:"rgba(68,75,88,0.2)",size:1},tickText:{show:!0,family:"Helvetica Neue",weight:"normal",size:12,paddingLeft:3,paddingRight:6},tickLine:{show:!1,size:1,length:3}},separator:{size:1,color:"rgba(68,75,88,0.2)",fill:!0,activeBackgroundColor:"rgba(230, 230, 230, .15)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:"dash",dashValue:[4,2],size:1,color:"#888888"},text:{show:!0,color:"#D9D9D9",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderColor:"#505050",borderRadius:2,backgroundColor:"#505050"}},vertical:{show:!0,line:{show:!0,style:"dash",dashValue:[4,2],size:1,color:"#888888"},text:{show:!0,color:"#D9D9D9",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderColor:"#505050",borderRadius:2,backgroundColor:"#505050"}}},shape:{point:{backgroundColor:"#2196F3",borderColor:"#2196F3",borderSize:1,radius:4,activeBackgroundColor:"#2196F3",activeBorderColor:"#2196F3",activeBorderSize:1,activeRadius:6},line:{style:"solid",color:"#2196F3",size:1,dashValue:[2,2]},polygon:{style:"stroke",stroke:{style:"solid",size:1,color:"#2196F3",dashValue:[2,2]},fill:{color:"rgba(33, 150, 243, 0.1)"}},arc:{style:"stroke",stroke:{style:"solid",size:1,color:"#2196F3",dashValue:[2,2]},fill:{color:"#2196F3"}},text:{style:"fill",color:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",offset:[0,0]}},annotation:{position:"top",offset:[20,0],symbol:{type:"diamond",size:8,color:"#2196F3",activeSize:10,activeColor:"#FF9600"}},tag:{position:"point",offset:0,line:{show:!0,style:"DASH",dashValue:[4,2],size:1,color:"#2196F3"},text:{color:"#FFFFFF",backgroundColor:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderRadius:2,borderSize:1,borderColor:"#2196F3"},mark:{offset:0,color:"#FFFFFF",backgroundColor:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderRadius:2,borderSize:1,borderColor:"#2196F3"}}},j=[{close:4976.16,high:4977.99,low:4970.12,open:4972.89,timestamp:158766e7,volume:204},{close:4977.33,high:4979.94,low:4971.34,open:4973.2,timestamp:158766006e4,volume:194},{close:4977.93,high:4977.93,low:4974.2,open:4976.53,timestamp:158766012e4,volume:197},{close:4966.77,high:4968.53,low:4962.2,open:4963.88,timestamp:158766018e4,volume:28},{close:4961.56,high:4972.61,low:4961.28,open:4961.28,timestamp:158766024e4,volume:184},{close:4964.19,high:4964.74,low:4961.42,open:4961.64,timestamp:15876603e5,volume:191},{close:4968.93,high:4972.7,low:4964.55,open:4966.96,timestamp:158766036e4,volume:105},{close:4979.31,high:4979.61,low:4973.99,open:4977.06,timestamp:158766042e4,volume:35},{close:4977.02,high:4981.66,low:4975.14,open:4981.66,timestamp:158766048e4,volume:135},{close:4985.09,high:4988.62,low:4980.3,open:4986.72,timestamp:158766054e4,volume:76}],Q={key:2,class:"flex px-4 py-4 box-border justify-between indicator-box",style:{"border-top":"1px solid rgba(68,75,88,0.2)"}},q=["onClick"],G={__name:"index",props:{symbol:{type:String},height:{type:Number},chartType:{type:String,default:"candle_solid"},showBottom:{type:Boolean,default:!0},isShowsolid:{type:Boolean,default:!1}},emits:["data","loading"],setup(w,{emit:_}){I.exports.useI18n();const a=A();let o=null;const b=n(""),S=n("MA"),L=n(["MA","EMA","BOLL","VOL","MACD","KDJ","RSI"]),t=n(j),f=n(0);n(!1);const h=n(!1),d=n(null),m=n(null),p=_;M(()=>{f.value=window.innerHeight-94,u(async()=>{await V(),await B(),R()})});const i=w,R=()=>{x(),d.value=new WebSocket(`${$}/1/${i.symbol}`),d.value.onmessage=e=>{const{data:r}=e,{code:l,data:s}=JSON.parse(r);l/1===0&&(p("data",s[0]),N(s[0]))}};O(()=>{x()});const x=()=>{d.value&&d.value.close(),d.value=null},N=async e=>{const r=o.getDataList();if(!r||r.length===0)return;const l=r[r.length-1];if(e.timestamp-l.timestamp>=a.seconds)return t.value=await y(i.symbol,a.stage==="timeSharing"?"1min":a.stage),t.value.unshift(),t.value.push({high:e.high,low:e.low,close:e.close,open:e.open,timestamp:e.timestamp}),o.applyNewData(t.value),!1;const s={close:e.close/1,current_time:l.current_time,high:l.high>e.close/1?l.high:e.close/1,line:a.stage==="timeSharing"?"1min":a.stage,low:l.low<e.close/1?l.low:e.close/1,open:l.open,symbol:l.symbol,timestamp:e.timestamp-l.timestamp<a.seconds?l.timestamp:l.timestamp+a.seconds,volume:e.volume/1};u(()=>{o.setStyleOptions({candle:{type:i.chartType},yAxis:{width:a.stage==="timeSharing"?0:null}}),o.updateData(s)})},B=async()=>{o=T.exports.init("kline",C),o.setOffsetRightSpace(15),o.setDataSpace(10),i.isShowsolid&&(o.createTechnicalIndicator("MA",!1,{id:"candle_pane"}),b.value=o.createTechnicalIndicator("MA")),o.setStyleOptions({candle:{type:i.chartType},yAxis:{width:a.stage==="timeSharing"?0:null}}),a.stage||a[F]({stage:"1min",seconds:1*60*1e3}),p("loading",!0),h.value=!0,await k(),h.value=!1,p("loading",!1);let e=2;t.value.length>0&&(e=t.value[t.value.length-1].decimals),o.setPriceVolumePrecision(e,2),localStorage.setItem("kline",JSON.stringify(t.value)),u(()=>{o.applyNewData(t.value)})},k=async()=>{if(t.value=await y(i.symbol,a.stage==="timeSharing"?"1min":a.stage),t.value.length==0)m.value=setTimeout(async()=>{await k()},2e3);else{m.value&&(clearTimeout(m.value),m.value=null),h.value=!1,p("loading",!1);let e=2;t.value.length>0&&(e=t.value[t.value.length-1].decimals),o.setPriceVolumePrecision(e,2),localStorage.setItem("kline",JSON.stringify(t.value)),u(()=>{console.log("ppp"),o.applyNewData(t.value)})}},V=async()=>{o=T.exports.init("kline",C),o.setOffsetRightSpace(15),o.setDataSpace(10),t.value=JSON.parse(localStorage.getItem("kline")),t.value||(t.value=await y(i.symbol,a.stage==="timeSharing"?"1min":a.stage));let e=2;t.value.length>0&&t.value[t.value.length-1].decimals,o.setPriceVolumePrecision(e,2),o.setStyleOptions({candle:{type:i.chartType}}),a.stage||a[F]({stage:"1min",seconds:1*60*1e3}),u(()=>{o.applyNewData(t.value)})},H=e=>{S.value=e,o.createTechnicalIndicator(e,!1,{id:b.value})};return(e,r)=>{const l=U;return c(),g(z,null,[h.value?(c(),P(l,{key:0,color:"#1194F7",class:"loading-box"})):v("",!0),f.value?(c(),g("div",{key:1,id:"kline",class:"boxDisplay",style:J({height:`${i.height||f.value}px`,position:"relative"})},null,4)):v("",!0),w.showBottom?(c(),g("ul",Q,[(c(!0),g(z,null,E(L.value,s=>(c(),g("li",{key:s,class:K(["mr-2",{textColor:S.value===s}]),onClick:Y=>H(s)},W(s),11,q))),128))])):v("",!0)],64)}}},oe=D(G,[["__scopeId","data-v-290b339b"]]);export{oe as f};
