import{_ as P,r as n,l as Z,o as f,c as x,e,f as s,t as l,d as U,aW as ue,bb as he,F as ee,m as ce,aA as be,n as T,i as te,al as se,v as xe,a as de,u as oe,ak as ne,a4 as ge,a8 as $e,bI as ke,bQ as Ce,aZ as ve,h as le,b as X,aX as we,g as B,w as me,s as J,bR as pe,S as fe,bn as _e,aj as Fe,bi as re,at as Te,I as Se,bS as Ie,b0 as je,au as He,bT as Oe}from"./index-14d2cc83.js";import{P as Le,f as De,a as Ne}from"./position-62afc883.js";import{h as ae,i as ye,j as qe,g as Ue,k as Y}from"./trade.api-43084cdd.js";import{d as ie}from"./dayjs.min-353269dd.js";import{_ as Be}from"./record-e0832bfd.js";import{_ as Ae,a as Re}from"./black-convert-e248d682.js";import"./red-leverage-a6d5d047.js";import"./index-e5c3334a.js";/* empty css               */import"./icon-close-a4b849b5.js";import"./index-237d7e99.js";const Pe={class:"contact-futrue"},Qe={key:0},ze={class:"w-full border-main tabBackground h-336 absolute top-0 left-0",style:{"overflow-y":"auto","z-index":"2"}},Ee=["onClick"],Me={__name:"selectTime",props:{initFutrue:{type:Object,default(){return{}}}},emits:["paraId"],setup(i,{emit:S}){const w=S,v=i;n(0);let m=n(!1),$=n(""),a=n({});Z(()=>{v.initFutrue&&v.initFutrue.para.length>0&&(a.value=v.initFutrue.para&&v.initFutrue.para[0]?v.initFutrue.para[0]:{},$.value=a.value.para_id?a.value.para_id:"",w("paraId",{id:$.value,index:0}))});const h=(r,b)=>{m.value=!1,a.value=r,$.value=r.para_id,w("paraId",{id:$.value,index:b})};return(r,b)=>(f(),x("div",Pe,[e("div",{class:"h-20 textColor3 border-main rounded-xl 0 pl-10 relative flex items-center",onClick:b[0]||(b[0]=_=>te(m)?m.value=!s(m):m=!s(m))},[s(a).profit_ratio?(f(),x("span",Qe,l(s(a).time_num+(s(a).time_unit?s(a).time_unit.substr(0,1):""))+" \xA0-\xA0"+l(s(a).profit_ratio?s(a).profit_ratio.split("~")[0]:"")+"% ",1)):U("",!0),ue(e("ul",ze,[(f(!0),x(ee,null,ce(i.initFutrue.para,(_,I)=>(f(),x("li",{key:_.para_id,class:"h-20 flex items-center",onClick:be(k=>h(_,I),["stop"])},[e("p",{class:T(["w-95 h-full flex justify-center items-center text-26 flex-1",s($)===_.para_id?"contBackground colorMain":"textColor"])},l(_.time_num+_.time_unit.substr(0,1))+"\xA0-\xA0"+l(_.profit_ratio?_.profit_ratio.split("~")[0]:"")+"% ",3)],8,Ee))),128))],512),[[he,s(m)]])])]))}},Ve=P(Me,[["__scopeId","data-v-6dc3b598"]]);const We={class:"perpetual-open"},Je={class:"pt-2 pb-10"},Xe={class:"flex"},Ze={class:"w-full flex flex-col"},Ge={key:0,class:"status-info"},Ke={class:"time"},Ye={class:"flex-1 pb-5 text-30 font-bold"},et={class:"text-red"},tt={class:"flex textColor text-30 borderColor items-center h-20",style:{"border-radius":"4px"}},st={class:"flex justify-between h-16 items-center mt-2"},ot={class:"textColor3 text-28"},nt={class:"textColor3"},lt={class:"flex justify-between h-16 items-center"},rt={class:"textColor3 text-28"},at={class:"flex justify-between h-16 items-center"},it={class:"textColor3 text-28"},ut={class:"textColor3"},ct={class:"flex justify-between h-16 items-center mb-8"},dt={class:"textColor3 text-28"},vt={key:0,class:"h-10"},mt={class:"flex justify-between h-20 items-center"},pt={class:"textColor3 text-28"},ft={class:"flex items-center border-main h-20 rounded-lg"},_t=["placeholder"],yt={class:"flex items-center mt-10 textColor1"},ht={class:"flex justify-between h-16 items-center mt-2"},bt={class:"textColor3 text-26"},xt={class:"textColor3"},gt={class:"flex text-26 textColor3 justify-between mt-2"},$t={class:"textColor"},kt={class:"text-30 relative text-center flex justify-center items-center",style:{"flex-grow":"1"}},Ct={class:"relative text-30 text-center flex justify-center items-center",style:{"flex-grow":"1"}},wt={key:2,class:"w-full mt-15"},Ft={class:"textColor"},Tt={class:"pt-8"},St={__name:"index",props:{greenData:{type:Array,default(){return[]}},redData:{type:Array,default(){return[]}},symbol:{type:String,default:""},price:{type:[Number,String],default:"0.00"},initOpen:{type:Object,default(){return{}}},initFutrue:{type:Object,default(){return{}}},currentType:{type:String,default:"long"}},emits:["changeCurrentType","ordered"],setup(i,{emit:S}){const w=se(),{t:v}=xe.exports.useI18n(),m=de(),$=oe(),a=ne(),h=S,r=i;n("");let b=n(null),_=n(null),I=n({}),k=n(!1),D=n("confirm");n(!1);let j=n(0),p=n({symbol:"",session_token:"",direction:"buy",price_type:"opponent",lever_rate:1,price:"",amount:"",para_id:""}),O=n(""),u=n(-1),y=n(0),F=null,C=n({});const g=ge(()=>o=>isNaN(o)?"--":o);$e(r.price,()=>{p.value.para_id=r.initFutrue.para&&r.initFutrue.para[j.value].para_id}),Z(()=>{Q(),H()}),ke(()=>{z(),E(),F&&F.close(),F=null});const Q=()=>{_.value=setInterval(G,500)},G=()=>{Ce().then(o=>{O.value=o.now?ie(o.now).format("HH:mm:ss"):ie().format("HH:mm:ss")})},N=(o,t)=>{u.value=t,r.initFutrue.amount==0||r.initFutrue.amount==""?p.value.amount=0:p.value.amount=r.initFutrue.amount*o},K=o=>{k.value=!1},z=()=>{clearTimeout(b.value),b.value=null},E=()=>{clearInterval(_.value),_.value=null},M=o=>{ae(o).then(t=>{z(),I.value=t,t.state!=="created"&&(b.value=setTimeout(()=>{M(o)},1e3))})},V=({id:o,index:t})=>{r.initFutrue&&r.initFutrue.para.length>0?(y.value=r.initFutrue.para[t].buy_min,console.log(y.value)):y.value=0,p.value.para_id=o,p.value.amount="",j.value=t},L=o=>{console.log("changeTab",o),r.currentType!==o&&h("changeCurrentType",o)},A=()=>{k.value=!1,setTimeout(()=>{D.value="confirm"},500)},R=o=>{if(!m.userInfo.token)return $.push("/login"),!1;if(!p.value.amount){J(v("\u8BF7\u8F93\u5165\u91D1\u989D"));return}p.value.symbol=a.params.symbol,p.value.direction=o==="long"?"buy":"sell";let t=null,c=null;p.value.session_token=r.initFutrue.session_token,t=qe,c="futrue",r.initFutrue.session_token==null||r.initFutrue.session_token==""?ye(r.symbol).then(d=>{p.value.session_token=d.session_token,q(t,c)}).catch(d=>{d.code=="ECONNABORTED"?J(v("\u7F51\u7EDC\u8D85\u65F6\uFF01")):d.msg!=null&&J(v(d.msg))}):(p.value.session_token=r.initFutrue.session_token,q(t,c))},q=(o,t)=>{o(p.value).then(c=>{p.value.amount="",J(v("success")),pe().then(d=>{w[{balance:d.money}]}),h("ordered",t),ae(c.order_no).then(d=>{I.value=d,k.value=!0})}).catch(()=>{h("ordered",t)})},H=()=>{F=new WebSocket(`${ve}/1/${a.params.symbol}`),F.onmessage=o=>{var W;const{data:t}=o,{code:c,data:d}=JSON.parse(t);c/1===0&&(C.value=(W=d[0])!=null?W:{})}};return(o,t)=>{const c=fe;return f(),x("div",We,[e("div",Je,[e("div",Xe,[e("div",Ze,[s(C).market&&s(C).market.status?(f(),x("p",Ge,[e("span",null,l(s(C).market.status&&o.$t(s(C).market.status))+",",1),e("span",Ke,l(s(C).market.time_str),1),t[11]||(t[11]=le("\xA0 ",-1)),e("span",null,l(s(C).market.time_zone&&o.$t(s(C).market.time_zone)),1)])):U("",!0),e("div",null,[e("div",Ye,[le(l(o.$t("\u73B0\u4EF7"))+" ",1),e("span",et,l(i.price||"--"),1)]),e("div",tt,[e("div",{class:T(["flex-1 text-center h-full flex justify-center items-center",i.currentType=="long"?"bg-green text-white":""]),style:{"border-top-left-radius":"4px","border-bottom-left-radius":"4px"},onClick:t[0]||(t[0]=d=>L("long"))},l(o.$t("buy")),3),e("div",{class:T(["flex-1 text-center h-full flex justify-center items-center",i.currentType=="short"?"bg-red text-white":""]),style:{"border-top-right-radius":"4px","border-bottom-right-radius":"4px"},onClick:t[1]||(t[1]=d=>L("short"))},l(o.$t("sell")),3)]),e("div",st,[e("span",ot,l(o.$t("time")),1),e("span",nt,l(s(O)),1)]),e("div",lt,[e("span",rt,l(o.$t("tradingAssets")),1),t[12]||(t[12]=e("span",{class:"textColor3 text-28",style:{color:"#d6cc62"}},"USD",-1))]),e("div",at,[e("span",it,l(o.$t("\u53EF\u7528\u6570\u91CF")),1),e("span",ut,l(g.value(i.initFutrue.amount)),1)]),e("div",ct,[e("span",dt,l(o.$t("transactionPeriod")),1)]),i.initFutrue.para?(f(),X(Ve,{initFutrue:i.initFutrue,onParaId:V,key:i.initFutrue.para},null,8,["initFutrue"])):(f(),x("div",vt)),e("div",mt,[e("span",pt,l(o.$t("number")),1)])]),e("div",ft,[ue(e("input",{placeholder:o.$t("\u6700\u5C0F\u91D1\u989D")+s(y),type:"number",class:"border-none rounded-xl text-center textColor w-full h-full","onUpdate:modelValue":t[2]||(t[2]=d=>s(p).amount=d)},null,8,_t),[[we,s(p).amount]])]),e("div",yt,[e("span",{class:T([[s(u)==0?"active":""],"flex-1 text-center border-main rounded-lg mr-5 py-2"]),onClick:t[3]||(t[3]=d=>N(.25,0))},"25%",2),e("span",{class:T([[s(u)==1?"active":""],"flex-1 text-center border-main rounded-lg mr-5 py-2"]),onClick:t[4]||(t[4]=d=>N(.5,1))},"50%",2),e("span",{class:T([[s(u)==2?"active":""],"flex-1 text-center border-main rounded-lg mr-5 py-2"]),onClick:t[5]||(t[5]=d=>N(.75,2))},"75%",2),e("span",{class:T([[s(u)==3?"active":""],"flex-1 text-center border-main rounded-lg py-2"]),onClick:t[6]||(t[6]=d=>N(1,3))},"100%",2)]),e("div",ht,[e("span",bt,l(o.$t("minimumBuy")),1),e("span",xt,l(i.initFutrue.para&&i.initFutrue.para[0]?i.initFutrue.para[s(j)].buy_min:""),1)]),e("div",gt,[e("div",null,l(o.$t("free")),1),e("div",$t,l((s(p).amount*(i.initFutrue&&i.initFutrue.para&&i.initFutrue.para[0]?i.initFutrue.para[s(j)].unit_fee:"")).toFixed(2))+" USD ",1)]),s(m).userInfo.token?(f(),x(ee,{key:1},[i.currentType=="long"?(f(),x("div",{key:0,class:"w-full h-20 bg-green flex text-white rounded-md mt-5",onClick:t[7]||(t[7]=d=>R("long"))},[e("div",kt,l(o.$t("buyLong")),1)])):U("",!0),i.currentType=="short"?(f(),x("div",{key:1,class:"w-full h-20 bg-red flex text-white rounded-md mt-5",onClick:t[8]||(t[8]=d=>R("short"))},[e("div",Ct,l(o.$t("buyShort")),1)])):U("",!0)],64)):(f(),x("div",wt,[e("div",Ft,[e("p",null,l(o.$t("\u5957\u671F\u4FDD\u503C\uFF0C\u98CE\u9669\u5BF9\u51B2")),1),e("p",Tt,l(o.$t("\u767B\u9646\u540E\u7EE7\u7EED")),1)]),e("div",{class:"h-10 btnBackground flex rounded-md justify-center mt-12",onClick:t[9]||(t[9]=d=>o.$router.push("/login"))},l(o.$t("logIn")),1)]))])])]),B(c,{show:s(k),"onUpdate:show":t[10]||(t[10]=d=>te(k)?k.value=d:k=d),class:"rounded-2xl",teleport:"body"},{default:me(()=>[(f(),X(Le,{showBtns:"",detailData:s(I),key:s(I).order_no,onClose:A,onContinueToBuy:K,onTimeEnd:M,price:i.price},null,8,["detailData","price"]))]),_:1},8,["show"])])}}},It=P(St,[["__scopeId","data-v-16861e83"]]);const jt={class:"perpetual-order"},Ht={class:"items-center mt-18"},Ot={class:"flex justify-between items-center border-b-color"},Lt={class:"flex items-center"},Dt={key:0},Nt={key:1},qt={__name:"index",props:{symbol:{type:String,default:""},orderCur:{type:Array,default(){return[]}},orderHold:{type:Array,default(){return[]}},futrueHold:{type:Array,default(){return[]}},futrueHistroy:{type:Array,default(){return[]}},price:{type:[Number,String],default:"0.00"}},emits:["tab"],setup(i,{emit:S}){const w=oe(),v=S;let m=n("");const $=i;Z(()=>{m.value="3",a("3")}),_e(()=>{m.value="3",this.tabClick("3")});const a=r=>{m.value=r,r=="1"&&v("tab","fetchOrderListHold"),r==="2"&&v("tab","fetchOrderListCur"),r==="3"&&v("tab","fetchFutrueHoldList"),r==="4"&&v("tab","fetchFutrueHistory")},h=()=>{w.push({path:"/foreign/ForexDeliveryContractHistory",query:{symbol:$.symbol}})};return(r,b)=>(f(),x("div",jt,[e("div",Ht,[e("div",Ot,[e("div",Lt,[e("div",{class:T(["w-60 py-5 flex flex-col items-center textColor1",s(m)=="3"?"active-line":""]),onClick:b[0]||(b[0]=_=>a("3"))},l(r.$t("\u6301\u6709\u4ED3\u4F4D")),3),e("div",{class:T(["w-60 ml-15 py-5 text-grey flex flex-col items-center textColor1",s(m)=="4"?"active-line":""]),onClick:b[1]||(b[1]=_=>a("4"))},l(r.$t("\u5386\u53F2\u4ED3\u4F4D")),3)]),e("img",{src:Be,alt:"record-img",class:"w-8 h-8 mr-8",onClick:h})]),s(m)=="3"?(f(),x("div",Dt,[B(De,{price:i.price,"list-data":i.futrueHold},null,8,["price","list-data"])])):U("",!0),s(m)=="4"?(f(),x("div",Nt,[B(Ne,{"list-data":i.futrueHistroy},null,8,["list-data"])])):U("",!0)])]))}},Ut=P(qt,[["__scopeId","data-v-e65494c8"]]);const Bt={class:"contract-header"},At={class:"pl-4 pr-4"},Rt={class:"flex justify-start pt-8 pb-4 before"},Pt={class:"flex items-center text-32"},Qt=["src"],zt={class:"text-32"},Et={class:"ml-4"},Mt={class:"pl-10 border-b-color pt-12 pb-12"},Vt={class:"textColor"},Wt={class:"font-bold text-36 mr-3"},Jt={class:"pl-10 pr-10"},Xt={class:"flex justify-between mb-21 mt-8 text-30"},Zt={class:"flex items-center text-grey"},Gt={class:"mr-3"},Kt={class:"flex text-grey"},Yt={class:"flex items-center"},es={class:""},ts={class:"flex items-center"},ss={class:"mr-3"},os=["onClick"],ns={class:"textColor text-32"},ls={class:"text-grey mt-1 text-24"},rs={class:"text-right"},as={class:"textColor"},is={__name:"index",props:{backFunc:{type:Function,default:null},balance:{type:[String,Number],default:0},symbol:{type:String,default:""},range:{type:String,defalult:""},selectIndex:{type:[String,Number],defalult:""}},emits:["update-coin","tab"],setup(i,{emit:S}){const w=Fe(),v=oe(),m=ne(),$=S,a=se();let h=n(!1),r=n(null),b=n([]);const _=new URL(Object.assign({"../../../assets/theme/dark/image/black-convert.png":Ae,"../../../assets/theme/white/image/black-convert.png":Re})[`../../../assets/theme/${w.theme}/image/black-convert.png`],self.location),I=u=>{if(m.params.symbol!==u.symbol){let y=m.name;v.push(`/foreign/${y}/${u.symbol}`),y=="deliveryContract"?re("jgSymbol",u.symbol):re("symbol",u.symbol),j(),$("update-coin",u.symbol)}h.value=!1},k=()=>{h.value=!0,D()},D=()=>{Te(a.coins).then(u=>{b.value=u,r.value&&(clearTimeout(r.value),r.value=null),r.value=setTimeout(()=>{D()},1e3)})},j=()=>{r.value&&(clearTimeout(r.value),r.value=null)},p=()=>{v.push("/quotes/index?tabActive=2")},O=u=>new URL(u,import.meta.url).href;return(u,y)=>{const F=Se,C=fe;return f(),x("div",null,[e("div",Bt,[e("div",At,[e("div",Rt,[e("div",{class:"icon icon_back_1",onClick:y[0]||(y[0]=g=>p())},[B(F,{name:"arrow-left",size:"20"})]),e("div",Pt,[e("img",{src:O(s(_)),alt:"convert-img",class:"w-10 h-10",onClick:k},null,8,Qt),e("div",{class:"flex pl-2 textColor font-bold",onClick:k},[e("div",zt,l(i.symbol.toUpperCase()||"--"),1),e("div",Et,l(u.$t("delivery")),1)]),e("div",{class:T(["pl-4 w-20",{"text-green":i.range>0,"text-red":i.range<=0}])},l(i.range>0?"+":"")+l(i.range||"--")+"%",3)])])])]),B(C,{class:"popup",round:"",show:s(h),"onUpdate:show":y[1]||(y[1]=g=>te(h)?h.value=g:h=g),"close-icon-position":"top-left",position:"left",onClosed:j},{default:me(()=>[e("div",Mt,[e("div",Vt,[e("span",Wt,l(u.$t("\u4EA4\u5272\u5408\u7EA6")),1),y[2]||(y[2]=e("span",{class:"text-24"},"/ USD",-1))])]),e("div",Jt,[e("div",Xt,[e("div",Zt,[e("div",Gt,l(u.$t("name")),1)]),e("div",Kt,[e("div",Yt,[e("div",es,l(u.$t("newPrice")),1)]),e("div",ts,[e("div",ss,"/24H"+l(u.$t("change")),1)])])]),(f(!0),x(ee,null,ce(s(b),g=>(f(),x("div",{class:"flex justify-between mb-7",key:g.name,onClick:Q=>I(g)},[e("div",null,[e("div",ns,l(g.symbol),1),e("div",ls,l(i.selectIndex==1?u.$t("\u6C38\u7EED"):u.$t("delivery")),1)]),e("div",rs,[e("div",as,l(g.close),1),e("div",{class:T(["mt-1",g.change_ratio>0?"text-green":"text-red"])},l(g.change_ratio)+"%",3)])],8,os))),128))])]),_:1},8,["show"])])}}},us=P(is,[["__scopeId","data-v-2bd48ece"]]);const cs={class:"mainBackground rounded-view"},ds={__name:"deliveryContract",setup(i){const S=de(),w=se(),v=ne();n(null);let m=n(0);n(null);let $=n(null);n(null),n(0);let a=n(""),h=n(""),r=n(""),b=n({});const _=[];for(let t=0;t<6;t++)_.push({amount:"--",price:"--"});let I=n(_),k=n(_),D=n([]),j=n([]),p=n([]),O=n([]),u=n({quotes:null,deep:null}),y=n("fetchFutrueHoldList"),F=n(2),C=n({});n(!1),n(!1),n(!1);let g=n("");const Q=t=>{a.value=t,q(),R(t)},G=()=>{H(),Ue({symbol:a.value,type:"orders",page_no:1,symbolType:"cryptos"}).then(t=>{j.value=t}),y.value=="fetchFutrueHoldList"?L(a.value):A(a.value)},N=t=>{H(),console.log(t),V(a.value,t),y.value=="fetchFutrueHoldList"?L(a.value):A(a.value)},K=t=>{console.log("evt",t),H(),y.value=t,y.value=="fetchFutrueHoldList"?L(a.value):A(a.value)},z=t=>{Oe(t).then(c=>{E(c),M()})},E=t=>{if(t&&t.length){const c=t[0];h.value=c.close,r.value=c.change_ratio+""}},M=()=>{u.value.quotes=new WebSocket(`${ve}/1/${a.value}`),u.value.quotes.onmessage=t=>{const{data:c}=t,{code:d,data:W}=JSON.parse(c);d/1===0&&E(W)}},V=(t,c)=>{(c==="futrue"||!c)&&ye(t).then(d=>{C.value=d})},L=t=>{S.userInfo.token&&(Y(t).then(c=>{p.value=c}),$.value=setInterval(()=>{Y(t).then(c=>{p.value=c})},1e3))},A=t=>{Y(t,"hisorders").then(c=>{O.value=c})},R=t=>{a.value=t,z(t),V(t),H(),L(t)},q=()=>{u.value.quotes&&u.value.quotes.close(),u.value.deep&&u.value.deep.close(),u.value.quotes=null,u.value.deep=null},H=()=>{clearInterval($.value),$.value=null},o=t=>{g.value=t};return Z(async()=>{let t=v.params.symbol;t&&(a.value=t,R(a.value)),w.coinList.length||await w[Ie](),pe().then(c=>{w[{balance:c.money}]}),g.value=v.query.currentType?v.query.currentType:"long"}),je(()=>{q(),H()}),_e(()=>{g.value=v.query.currentType?v.query.currentType:"long"}),He(()=>{q(),H()}),(t,c)=>(f(),x("div",{key:s(a),class:"pb-108"},[B(us,{symbol:s(a),range:s(r),selectIndex:s(F),balance:s(S).userInfo.balance,onUpdateCoin:Q,page:"perpetualContract"},null,8,["symbol","range","selectIndex","balance"]),e("div",null,[e("div",cs,[(f(),X(It,{class:"pl-8 pr-8",key:s(m)+"c",selectIndex:s(F),symbol:s(a),"green-data":s(k),"red-data":s(I),price:s(h),"init-open":s(b),"init-futrue":s(C),onOrdered:N,currentType:s(g),onChangeCurrentType:o},null,8,["selectIndex","symbol","green-data","red-data","price","init-open","init-futrue","currentType"])),c[0]||(c[0]=e("div",{class:"line"},null,-1)),(f(),X(Ut,{class:"pl-8 pr-8",key:s(m)+"d",symbol:s(a),"order-cur":s(D),"order-hold":s(j),price:s(h),topIndex:s(F),"futrue-hold":s(p),"futrue-histroy":s(O),onTab:K,onRecall:G},null,8,["symbol","order-cur","order-hold","price","topIndex","futrue-hold","futrue-histroy"]))])])]))}},ks=P(ds,[["__scopeId","data-v-303836e1"]]);export{ks as default};
