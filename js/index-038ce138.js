import{_ as E,I as m,cI as u,s as v,am as U,aq as y,o as n,c as r,e as s,g as h,w as d,F as p,h as _,t as o,b as N,d as O,aY as j,m as T,aW as D,aX as F,n as Y}from"./index-16c70849.js";import{U as A,s as G,_ as J}from"./index-380cff9d.js";/* empty css               *//* empty css              *//* empty css               */import{_ as b}from"./OrderNav-03614c6c.js";import{B as g}from"./index-bb9105b1.js";import{C as x}from"./index-4ea44f9f.js";import"./index-3f984ecc.js";import"./index-b64db57c.js";import"./index-19da7eed.js";const M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA6CAYAAAAQsBGlAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAU2SURBVHgB3VrBbttGEJ2lZJ160B+E/YP4VqCHSP2BKMee4nyBqUOSxjYgGQicujZg+gusfEHtcw9W0UtvUr8gyh+oQFOgkcTt7FBSEnKGXFFL2sgDZMm7s6N5muXszO4CfIVQcEcI+hdN+O9jCzzPBx01Y2u8KVo0hnp9Eva7EyiISkkRkdl8Dz8+Bq1bOeJjfF1CY2e4KcHKSAUHZz38tgDJNGFjqH548vzYWhpKBnrHh4+zX/HjQ9gOE/Ra28ZrHpSI4ODiIU63EWxPyMD8OKPg1WknT7A0TxEhNb8tNt0yMcVXOzx5MZYESiFlTUipIf69Qbnp8v8mRBGOVY/AeEbGFKfirjQV6+AYloSuIVp0w59fTWQ9v+zhWw94ciaKXuF7mxvr1FNWhLTuhm9ehmCj76c3Pni1W5C85ql2+Pr5MNUMjmDpoWe2hAzIkzjNwEQ+Dpo8mYITUtaETl4MYEPgc2OetydsJy7gwdFZK9m8NakyCa1AkU7rt2xnFLWSTVuRqoLQGjVvwLYr71GyqTCpSgkhKCAoNU11aO0nmwqFdBeEKH2azTuUoTcaA8uk1cgksxM/KbSxp5wQWqVPWl/g/Olh+vMO058A8jG1kNmMlDNCnA6lepAPq5TLmlSphGI0abGVxppaTGsuMU55z4pUBYQMJllpE05RPjtXKpXY5pKqiBClT5ANfnrq6PdkUyapygjF6dO11Nk9Ot8HMWtXqXFqa2NcEMrTAbMR36vGWObvJltZT9Eacl8IGR0i9CXXmlp8l3sKRtH9ICTruJbGpz01W0iFmStjXOiYmCJTGq++VEbV5hWUZ4wrHbtZexRJT/VKNsaVjnFG/ydSSy/5vJg+vkeEBpCDzz0leWkSnrzsQ4nGuC5jiNSyJPZZiWjRhhKNKaMuiz2l1VOhfyDlY/eVkEG8Tul0nU/wFLsvsN4f13e8lsWF5j79g3sYqwDiUQc/9abcnhohVuRDUWMcEOoenj9dFpoBvQBGq0LTg/ncZ0cxKf0aWnegoDGuCGkdDaRC04MovXFBYFJ6MiorqFRJiEfTFJMYKCRSwn6AFo9lBndMyMAcq07leorbjjJYnc+mO96DgEoIxfbSTu7m+37msJnvYA2ujJDW7XX0w5YJLylMSwVSANnHVOuLqUnPX8WEDOp45D/F/WhO+gGrpF4fYyidCoaOgsNzjEqL96BqD1DvHmTDOSEDDOkz6ZdvcY10CqGjS5CgDREMrfpuCBl4lAbxQcHnjkkIjUYoBhI7lEbIIA4UUXTDDo749Im8pYQzo3yUSsggJiUdk4Dap51RBssUSj7l44wxx5klEzLw1gby08kcGIvVMCk3pYl0ILYyBItM2PnwrZhLgjtCJLr6EByc9ukB5yAcGH+OoN9vwvybFpKMwzpdnsLlov7PMOz3M58/l4RI/JNRdBnqnRCqra/QbArXhAzWGUV8YBxJl5poL3BZpjhDGYRoWLIhODy7zbi2NsGp+CxvKtrA7I/rKApFgYKEaGiyIfdCRvyFIezUL4tMx2W1egVZ9/22IETD2S82OZxSeTkbLtreEHZqxzbkaCGPtKmYO5mCWxIiFVKHJbEVxkgQjdB/rS9PETApViaHVB0rPQ4IkZqszmXWbS4g+lA+Jvh6si0hg8x6ar24xlfYyoPRj9/jghCpsxXMuapW8NuVKXuON7mEZYOareCff/w2/u77H27QkL/RGh8sj/9ZxKnTKTT+/TF8fTQExyh83y84Ou/AYtHBIvOxdRAAfY3vb6H+YZyXOm2D/wE70RWUdgwXfQAAAABJRU5ErkJggg==",K="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAA2CAYAAABjhwHjAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKhSURBVHgB3ZpNctowFMffE246dEVvkAOQiY/ADegN0hs0u5BVmlUnu+QE7RGaEzQ5QbPIHm4QFu1gM9ivsqkA2xL4Q7IlfgvG3/Zv9Jf8bIPA8S9pEH8IL5JpFtHjy11/BkcAJj9nk2BKAKfbhfijR/Gt65I4vFqMAPGXdKXjkujf0GAVhm97N3JUMo3l8Dr8DUT+4Y3dkmTJD7/opzIbE9DnFeL0bBJ+968Wp2A5qRzF0WOVnVyRTGOZ9rtlOOVXPYAa2BpXFBPDSZCMmCNogG2SbGfqJzTEtrhu5Dxgz6AJWyRxd2Z4HbzV7Xf7T9JNXNnuDBI2jqaMrlqSZWdjbdGU0bZkJpZlSjG9JzcbV8wvyD8htIEpSVY8EzPS7/ZhKq4FuaqlmE50SxZi2Xa/20fTuKJsoY5STCd1JZnicE9gEXXjKpcjs/e7ulSVRNUKU6WYTg7FlSl3NFSK6eRQSyrliNELOIJKEqFj+MhMoBui29e7/tfjlON4wfuPDI6UqL869+AI4VGYvX5796yUSzrmCtkFGEdjKhHmQHj/Nzh5SGaVchHrfeE380twgf9SfxYnD7N7nIvFSjk+vI7AdhRS29US1pHEKdiKkArkUgJpy0VozxNBhgMtlUceS2RjfiMEa6goJZDKWdPfakoJCnLpl9aunwYaSgmKLdfDc4ihGzRJCYpyMXyCttEstT3sDq2/HCo5pNcl03LRcjmCNjDUUnmysSQYg0lakhLk+pyhW0DLUoKNXFpy6f5G0JGUYCOnteTqWEqwjaWOkssSKcFGrlHJZZmUIJWrXXJZKiVI5ZD1xkQVai7LpQSpXOlIOiIlwFJP3YbLJFN4EWO+cpR0rKXyeBTHc8DcqxTHpQTrP5NOwhv+WWf9Gs/B+Kn4B3gd/ullGO5EAAAAAElFTkSuQmCC";const V={name:"ChatIndex",props:["type"],components:{[m.name]:m,[g.name]:g,OrderNav:b,[A.name]:A,[x.name]:x},data(){return{list:[],lastMsgId:"",finished:!1,message:"",orderNo:"",detail:{},inter:null,timerData:null,time:""}},filters:{format(t){return Math.floor(t/60)+":"+t%60}},async created(){this.orderNo=this.$store.state.c2c.order_no;const t=await u.ctcOrderGetDetail({order_no:this.orderNo,language:this.$i18n.locale});this.detail=t;const{autoCancelTimeRemain:e}=this.detail;this.time=e*1e3,this.time>0&&(this.timerData=setInterval(()=>{this.time--,this.time<=0&&clearInterval(this.timerData)},2e3)),this.fetchList()},methods:{fixStrSell(){let t="";return this.detail.state==0?t=this.$t("\u7B49\u5F85\u4E70\u5BB6\u4ED8\u6B3E"):this.detail.state==1?t=this.$t("\u8BF7\u653E\u884C"):this.detail.state==2?t=this.$t("\u7533\u8BC9\u4E2D"):this.detail.state==3?t=this.$t("\u5DF2\u5B8C\u6210"):this.detail.state==4?t=this.$t("\u5DF2\u53D6\u6D88"):this.detail.state==5&&(t=this.$t("\u5DF2\u8D85\u65F6")),t},fixStrBuy(){let t="";return this.detail.state==1?t=this.$t("\u7B49\u5F85\u5356\u5BB6\u653E\u884C"):this.detail.state==2?t=this.$t("\u7533\u8BC9\u4E2D"):this.detail.state==3?t=this.$t("\u5DF2\u5B8C\u6210"):this.detail.state==4?t=this.$t("\u5DF2\u53D6\u6D88"):this.detail.state==5&&(t=this.$t("\u5DF2\u8D85\u65F6")),t},gotoPay(){this.detail.state==0&&this.$router.push({path:"/cryptos/paymentBuy"})},onOversize(t){console.log(t),v(this.$t("\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC710m"))},onPreview(t){G([t])},showTime(t){if(t===0)return!0;if(t===this.list.length-1||this.list[t].createtime.split(" ")[0]===this.list[t+1].createtime.split(" ")[1])return!1},afterRead(t){U({duration:0,forbidClick:!0}),J(t,e=>{console.log(e)}).then(e=>{y(),this.send("img",e)}).catch(()=>{y()})},fetchList(t=""){u.otcOnlinechatList({messageId:t,orderNo:this.detail.orderNo}).then(e=>{if(this.lastMsgId||(this.lastMsgId=e.length&&e[e.length-1].id),e.length){if(t)this.lastMsgId=e[e.length-1].id,this.list=[...e.reverse(),...this.list];else{this.list=[...this.list,...e.reverse()];let c={};this.list=this.list.reduce(function(f,i){return c[i.id]||(c[i.id]=f.push(i)),f},[])}e.length<10&&(this.finished=!0)}else this.list=[];t||(this.clearInterval(),this.inter=setInterval(()=>{this.fetchList()},2e3))})},onMore(){this.fetchList(this.lastMsgId)},clearInterval(){this.inter&&(clearInterval(this.inter),this.inter=null)},send(t="text",e=""){if(!e){v(this.$t("\u8BF7\u8F93\u5165\u6D88\u606F\u5185\u5BB9"));return}u.otcOnlinechat({orderNo:this.detail.orderNo,type:t,content:e}).then(c=>{console.log(c),this.message="",this.fetchList(),setTimeout(()=>{this.bottomScrollClick()},1e3)})},bottomScrollClick(){this.$nextTick(()=>{let t=this.$refs.mianscroll;t.scrollTo({top:t.scrollHeight+400,behavior:"smooth"})})}},beforeUnmount(){this.clearInterval()}},R={id:"cryptos"},W={class:"w-full h-full flex flex-col chat-page",ref:"mianscroll"},z={class:"w-full"},X={class:"flex items-center"},Q=["src"],q={class:"ml-11 font-bold text-28"},L={class:"pt-8 px-8 pb-8 tabBackground"},H={key:0,class:"text-40 c2cColor flex items-center"},Z={class:"text-blue"},P={class:"block text-blue"},$={class:"block text-blue"},tt={class:"block text-blue"},et={key:1,class:"text-40 c2cColor"},st={key:1,class:"text-40 font-semibold c2cColor"},lt={key:1,class:"text-40 c2cColor"},it={class:"flex justify-between items-center mt-8 mb-11"},ot={class:"text-26 text-black"},nt={class:"text-grey"},rt={class:"ml-3 c2cColor"},at={class:"content flex-1 pb-52"},ct={class:"flex flex-col px-8 box-border"},dt={class:"flex flex-col pt-5"},ht={class:"text-26 text-center py-20 text-grey"},pt=["src"],ft={class:"responser bg-grey px-12 py-9 rounded-lg text-26 chatBg bg-right",style:{"border-radius":"20px 20px 20px 0"}},ut={key:0,class:"break-word textColor",style:{"max-width":"230px","word-break":"break-word"}},mt=["src","onClick"],At={key:1,class:"py-6 px-10 rounded-lg flex flex-col chatBg bg-right",style:{"border-radius":"20px 20px 0 20px"}},gt=["src","onClick"],xt={key:1,class:"break-word textColor",style:{"max-width":"230px","word-break":"break-word",color:"#fff"}},vt={class:"fixed bottom-0 bottom-box left-0 w-full px-8 box-border pb-20"},yt={class:"pl-8 flex justify-between relative w-full h-28 items-center pr-36 box-border rounded-xl tabBackground chat-input"},_t=["placeholder"];function bt(t,e,c,f,i,a){const k=m,C=b,w=x,I=g,B=A;return n(),r("div",R,[s("div",W,[s("div",z,[h(C,null,{left:d(()=>[h(k,{name:"cross",class:"font-bold",color:"#868D9A"})]),title:d(()=>[s("div",X,[s("img",{class:"w-8 h-8",src:i.detail.c2cUserHeadImg,alt:""},null,8,Q),s("span",q,o(i.detail.c2cUserNickName),1)])]),_:1}),s("div",L,[i.detail.direction=="buy"?(n(),r(p,{key:0},[i.detail.state==0?(n(),r(p,{key:0},[i.time>0?(n(),r("div",H,[_(o(t.$t("\u8BA2\u5355\u5C06\u5728\u5012\u8BA1\u65F6\u7ED3\u675F\u65F6\u53D6\u6D88\u3002"))+"\xA0",1),s("span",Z,[h(w,{class:"flex font-bold mx-3 textColor",time:i.time},{default:d(l=>[s("span",P,o(l.hours),1),e[4]||(e[4]=s("span",{class:"colon text-blue"},":",-1)),s("span",$,o(l.minutes),1),e[5]||(e[5]=s("span",{class:"colon text-blue"},":",-1)),s("span",tt,o(l.seconds),1)]),_:1},8,["time"])])])):(n(),r("div",et,o(t.$t("\u60A8\u7684\u8BA2\u5355\u5DF2\u8D85\u65F6")),1))],64)):(n(),r("div",st,o(a.fixStrBuy()),1))],64)):(n(),r("div",lt,o(a.fixStrSell()),1)),s("div",it,[s("div",ot,[s("span",nt,o(t.$t("\u91D1\u989D")),1),s("span",rt,o(i.detail.currency)+" "+o(i.detail.amount&&i.detail.amount.toFixed(2)),1)]),s("div",{class:"text-30 text-blue",onClick:e[0]||(e[0]=l=>t.$router.push("/cryptos/appeal"))},o(t.$t("\u4E3E\u62A5")),1)]),i.detail.direction=="buy"&&i.detail.state==0?(n(),N(I,{key:2,class:"w-full text-32 rounded-lg",color:"#1D91FF",type:"info",onClick:a.gotoPay},{default:d(()=>[_(o(t.$t("\u53BB\u4ED8\u6B3E")),1)]),_:1},8,["onClick"])):O("",!0)])]),s("div",at,[s("div",ct,[s("div",{class:"w-full py-2 text-grey text-center pt-24",onClick:e[1]||(e[1]=(...l)=>a.onMore&&a.onMore(...l)),style:j({visibility:i.finished?"hidden":"visiable"})},o(t.$t("\u5386\u53F2\u6D88\u606F")),5),s("ul",dt,[(n(!0),r(p,null,T(i.list,(l,kt)=>(n(),r("li",{key:l.id,class:"flex flex-col mt-5"},[s("p",ht,o(l.createtime),1),s("div",{class:Y(["flex",l.send_receive==="send"?"justify-end":""])},[l.send_receive==="receive"?(n(),r(p,{key:0},[s("img",{src:i.detail.c2cUserHeadImg,class:"w-20 h-20 mr-10"},null,8,pt),s("div",ft,[l.type==="text"?(n(),r("p",ut,o(l.content),1)):(n(),r("img",{key:1,src:l.content,class:"w-48 h-48",onClick:S=>a.onPreview(l.content)},null,8,mt))])],64)):(n(),r("div",At,[l.type==="img"?(n(),r("img",{key:0,src:`${l.content}`,class:"w-48 h-48",onClick:S=>a.onPreview(l.content)},null,8,gt)):(n(),r("p",xt,o(l.content),1))]))],2)]))),128))])])]),s("div",vt,[s("div",yt,[h(B,{"max-size":1e4*1024,onOversize:a.onOversize,"after-read":a.afterRead},{default:d(()=>[...e[6]||(e[6]=[s("img",{src:M,class:"w-16 h-16"},null,-1)])]),_:1},8,["onOversize","after-read"]),D(s("input",{class:"w-full h-full text-32 pl-10 inputBackground c2cColor",type:"text","onUpdate:modelValue":e[2]||(e[2]=l=>i.message=l),placeholder:t.$t("\u8BF7\u8F93\u5165\u60A8\u7684\u6D88\u606F...")},null,8,_t),[[F,i.message]]),s("div",{class:"right-8 chat-icon",onClick:e[3]||(e[3]=l=>a.send("text",i.message))},[...e[7]||(e[7]=[s("img",{class:"w-14",src:K,alt:""},null,-1)])])])])],512)])}const Dt=E(V,[["render",bt],["__scopeId","data-v-13f22334"]]);export{Dt as default};
