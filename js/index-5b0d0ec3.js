import{_ as W,ak as X,u as Z,v as H,r as s,l as J,d1 as Q,a8 as Y,L as ee,o as f,c as _,g as v,w as V,e as o,t as i,aW as te,aX as oe,h as g,F as le,d as $,f as ae,s as n,cZ as se,c_ as ne,d2 as ue,bP as ie}from"./index-14d2cc83.js";/* empty css              */import{P as re,N as ce,_ as de}from"./reload-ce25e3d5.js";import{E as ve}from"./index-5e63b27b.js";import{a as pe}from"./login.api-e8bf4db7.js";import{n as me}from"./nationalityList-0a78eb76.js";import{u as fe}from"./index-2cfc45fd.js";import{B as _e}from"./index-e68322b9.js";import{I as ge}from"./index-21ab17c7.js";/* empty css               *//* empty css               *//* empty css               */import"./index-725c648c.js";import"./index-75673de3.js";import"./index-2fe68c30.js";import"./use-id-f3e51a3e.js";import"./index-db5e9f2d.js";const ye={class:"bindVerify"},he={class:"content"},be={key:0},Ce={class:"label mt-2 textColor"},$e={class:"iptbox inputBackground"},ke=["placeholder"],Ve={key:1},xe={class:"pl-30 pr-30 text-center flex flex-col items-center justify-center mt40"},we={class:"imgbox"},Ne={class:"code flex items-center justify-center textColor"},Ie={class:"tips"},Ee={class:"flex justify-between mt-6 mb-3"},Be={class:"flex items-center"},Pe={class:"mt-5 bottom tabBackground textColor"},Se={__name:"index",setup(Te){const B=X(),k=Z(),{t:l}=H.exports.useI18n(),{toClipboard:P}=fe(),y=s(""),u=s(""),x=s(!1),t=s(0),h=s(""),b=s(""),p=s(!1),r=s("");s(!0);const w=s(""),C=s(0),m=s(null),c=s(0),N=s("");J(()=>{S(),clearInterval(m.value),m.value=null});const S=()=>{t.value=B.query.type,t.value==1?(y.value=l("bindPhone"),x.value=!0):t.value==2?y.value=l("bindEmail"):t.value==3&&(y.value=l("googleAuthenticatorEn"),I())},T=()=>{if(t.value==2){if(u.value==""){n(l("entryEmail"));return}if(u.value.indexOf("@")===-1){n(l("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740"));return}}if(t.value==1&&u.value==""){n(l("entryPhone"));return}if(t.value==1&&isNaN(u.value)){n(l("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801"));return}if(c.value>0)return!1;pe({target:t.value==1?`${C.value}${u.value}`:u.value}).then(e=>{n(l("sendSuccess")),c.value=30,m.value=setInterval(()=>{c.value>0?c.value=c.value-1:(c.value=0,clearInterval(m.value),m.value=null)},1e3)})},A=()=>{if(t.value==2){if(u.value==""){n(l("entryEmail"));return}if(u.value.indexOf("@")===-1){n(l("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740"));return}}if(t.value==1&&u.value==""){n(l("entryPhone"));return}if(t.value==1&&isNaN(u.value)){n(l("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801"));return}t.value==1?j():t.value==2?G():t.value==3&&F()},G=()=>{se({email:u.value,verifcode:h.value}).then(e=>{n(l("bindSuccess")),k.push("/safety")})},j=()=>{ne({phone:`${C.value||""}${u.value}`,verifcode:h.value}).then(e=>{n(l("bindSuccess")),k.push("/safety")})},I=()=>{Q({}).then(e=>{b.value=e.googleAuthSecret,w.value=e.googleAuthImg})},F=()=>{if(!r.value){n(l("\u8BF7\u8F93\u5165\u8C37\u6B4C\u9A8C\u8BC1\u7801"));return}ue({secret:b.value,code:r.value}).then(e=>{e.google_auth_bind?(n(l("bindSuccess")),k.push("/safety")):n(l("bindFailed"))})},M=async()=>{try{await P(b.value),n(l("copySuccess"))}catch(e){console.error(e)}},R=async()=>{r.value=await navigator.clipboard.readText()},K=e=>{N.value=e.code,C.value=e.dialCode},E=s(null),L=()=>{E.value.open()};return Y(r,(e,a)=>{r.value.length===6&&(p.value=!1)}),(e,a)=>{const U=ie,D=ee,O=re,q=ce,z=_e;return f(),_("div",ye,[v(U,null,{title:V(()=>[g(i(y.value),1)]),_:1}),o("div",he,[t.value==1||t.value==2?(f(),_("div",be,[v(ve,{label:t.value==2?e.$t("email"):e.$t("phoneNum"),placeholderText:t.value==2?e.$t("entryEmail"):e.$t("entryPhone"),modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=d=>u.value=d),area:x.value,onSelectArea:L,dialCode:C.value,icon:N.value},null,8,["label","placeholderText","modelValue","area","dialCode","icon"]),o("p",Ce,i(e.$t("verificationCode")),1),o("div",$e,[te(o("input",{class:"inputBackground textColor",type:"text",placeholder:e.$t("entryVerifyCode"),"onUpdate:modelValue":a[1]||(a[1]=d=>h.value=d)},null,8,ke),[[oe,h.value]]),t.value!=3?(f(),_("span",{key:0,onClick:T},[g(i(e.$t("sendVerifyCode")),1),c.value?(f(),_(le,{key:0},[g(" ("+i(c.value)+")s",1)],64)):$("",!0)])):$("",!0)])])):$("",!0),t.value==3?(f(),_("div",Ve,[o("div",xe,[o("div",we,[v(ae(ge),{src:w.value},{loading:V(()=>[v(D,{type:"spinner",size:"20"})]),_:1},8,["src"])]),o("div",Ne,[g(i(b.value)+" ",1),o("img",{src:de,alt:"",onClick:I})]),o("p",Ie,i(e.$t("saveKeyTips")),1),o("div",{class:"copy textColor",onClick:M},i(e.$t("copy")),1)]),o("div",Ee,[o("div",null,i(e.$t("googleVerificationCode")),1),o("div",Be,[o("div",{class:"colorMain",onClick:a[2]||(a[2]=d=>r.value="")},i(e.$t("clear")),1),o("div",{class:"colorMain ml-30",onClick:R},i(e.$t("paste")),1)])]),v(O,{value:r.value,gutter:16,focused:p.value,onFocus:a[3]||(a[3]=d=>p.value=!0),mask:!1},null,8,["value","focused"]),v(q,{modelValue:r.value,"onUpdate:modelValue":a[4]||(a[4]=d=>r.value=d),show:p.value,onBlur:a[5]||(a[5]=d=>p.value=!1)},null,8,["modelValue","show"]),a[6]||(a[6]=o("div",{class:"mt-2"},null,-1)),o("div",Pe,[o("p",null,i(e.$t("precautions")),1),o("p",null,i(e.$t("precautionsTips1")),1),o("p",null,i(e.$t("precautionsTips2")),1)])])):$("",!0),v(z,{class:"w-full",style:{"margin-top":"10px"},type:"primary",onClick:A},{default:V(()=>[g(i(e.$t("confirm")),1)]),_:1})]),v(me,{ref_key:"controlChildRef",ref:E,title:e.$t("selectArea"),onGetName:K},null,8,["title"])])}}},Je=W(Se,[["__scopeId","data-v-b1b75616"]]);export{Je as default};
